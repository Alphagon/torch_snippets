---

title: Utilities for simple needs


keywords: fastai
sidebar: home_sidebar



nb_path: "nbs/index.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/index.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="err">```</span><span class="n">python</span>
<span class="kn">from</span> <span class="nn">torch_snippets</span> <span class="kn">import</span> <span class="n">Report</span>

<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">Report</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">)</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_epochs</span><span class="p">):</span>
    <span class="c1"># No need to --&gt; train_epoch_losses, train_epoch_accuracies = [], []</span>
    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">trn_dl</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">trn_dl</span><span class="p">)):</span>
        <span class="o">...</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="p">(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span> <span class="c1"># a float between 0 - n_epochs</span>
        <span class="c1"># give any number of kwargs that need to be reported and stored.</span>
        <span class="c1"># args should be float</span>
        <span class="n">log</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">train_acc</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">is_correct</span><span class="p">),</span> <span class="n">train_loss</span><span class="o">=</span><span class="n">batch_loss</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># impersistent log</span>

    <span class="n">N</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">val_dl</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">ix</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">iter</span><span class="p">(</span><span class="n">val_dl</span><span class="p">)):</span>
        <span class="o">...</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="p">(</span><span class="n">ix</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="n">N</span><span class="p">)</span> <span class="c1"># a float between 0 - n_epochs</span>
        <span class="n">log</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span> <span class="n">val_loss</span><span class="o">=</span><span class="n">batch_loss</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="p">)</span> <span class="c1"># impersistent log</span>
    <span class="n">log</span><span class="o">.</span><span class="n">report_avgs</span><span class="p">(</span><span class="n">epoch</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># persist the report</span>

<span class="err">```</span>
<span class="o">![](</span>../assets/demo.gif<span class="o">)</span>
<span class="o">*</span> <span class="n">Auto</span> <span class="n">calculates</span> <span class="n">time</span> <span class="n">remaining</span>
<span class="o">*</span> <span class="n">No</span> <span class="n">need</span> <span class="n">to</span> <span class="n">preinitialize</span> <span class="n">empty</span> <span class="n">lists</span>
<span class="o">*</span> <span class="n">Automatically</span> <span class="n">stores</span> <span class="n">metrics</span> <span class="k">as</span> <span class="n">collection</span> <span class="n">of</span> <span class="n">key</span> <span class="n">words</span>
<span class="o">*</span> <span class="n">Persistent</span> <span class="n">vs</span> <span class="n">Transient</span> <span class="n">logging</span> <span class="p">(</span><span class="n">use</span> <span class="err">`</span><span class="n">end</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\r</span><span class="s1">&#39;</span><span class="err">`</span><span class="p">)</span>  
<span class="err">```</span><span class="n">python</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nb">print</span><span class="p">(</span><span class="n">log</span><span class="o">.</span><span class="n">logged</span><span class="p">)</span> <span class="c1"># get logged metric names</span>
<span class="c1"># [&#39;train_loss&#39;, &#39;train_acc&#39;, &#39;val_loss&#39;, &#39;val_acc&#39;]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">log</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span> <span class="c1"># plot all the logged metrics</span>
<span class="err">```</span>


<span class="o">*</span> <span class="n">Auto</span> <span class="n">calculates</span> <span class="n">average</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">metrics</span> <span class="ow">in</span> <span class="n">an</span> <span class="n">epoch</span>
<span class="o">*</span> <span class="n">Plot</span> <span class="n">entire</span> <span class="n">training</span> <span class="n">history</span> <span class="k">with</span> <span class="n">one</span> <span class="n">command</span>  
<span class="o">![](</span>../assets/avgs0.png<span class="o">)</span>


<span class="o">*</span> <span class="n">selectively</span> <span class="n">plot</span> <span class="n">logged</span> <span class="n">metrics</span> <span class="n">using</span> <span class="n">regex</span>
<span class="err">```</span><span class="n">python</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">log</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;*_loss&#39;</span><span class="p">)</span>
<span class="c1"># or you can list out the metrics that need plotting</span>
<span class="c1"># &gt;&gt;&gt; log.plot([&#39;train_acc&#39;,&#39;val_acc&#39;])</span>
<span class="err">```</span>
<span class="o">![](</span>assets/avgs1.png<span class="o">)</span>

<span class="c1">## Auxiliary Functions</span>
<span class="n">There</span> <span class="n">are</span> <span class="n">simple</span> <span class="n">functions</span> <span class="n">that</span> <span class="n">are</span> <span class="n">overloaded</span> <span class="n">to</span> <span class="n">take</span> <span class="n">inputs</span> <span class="ow">and</span> <span class="n">perform</span> <span class="n">repetitive</span> <span class="n">tasks</span> <span class="n">that</span> <span class="n">usually</span> <span class="n">take</span> <span class="n">a</span> <span class="n">few</span> <span class="n">lines</span> <span class="n">to</span> <span class="n">write</span>
<span class="c1">#### Images</span>
<span class="err">`</span><span class="n">show</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">inspect</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">Glob</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">read</span><span class="err">`</span>
<span class="c1">#### FilePaths</span>
<span class="err">`</span><span class="n">stem</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">Glob</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">parent</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">name</span><span class="err">`</span>
<span class="c1">#### Dump and load python objects</span>
<span class="err">`</span><span class="n">loaddill</span><span class="err">`</span><span class="p">,</span><span class="err">`</span><span class="n">dumpdill</span><span class="err">`</span>
<span class="c1">#### Misc </span>
<span class="err">`</span><span class="n">Tqdm</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">Timer</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">randint</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">unique</span><span class="err">`</span><span class="p">,</span> <span class="err">`</span><span class="n">diff</span><span class="err">`</span>
<span class="c1">#### Pytorch Modules</span>
<span class="err">`</span><span class="n">Reshape</span><span class="err">`</span> <span class="ow">and</span> <span class="err">`</span><span class="n">Permute</span><span class="err">`</span> <span class="p">(</span><span class="err">`</span><span class="n">nn</span><span class="o">.</span><span class="n">Modules</span><span class="err">`</span><span class="p">)</span>


<span class="ow">and</span> <span class="n">many</span> <span class="n">more</span><span class="o">...</span> 
 
<span class="c1">## Install</span>
<span class="err">`</span><span class="n">pip</span> <span class="n">install</span> <span class="n">torch_snippets</span><span class="err">`</span>

<span class="c1">## Usage</span>
<span class="err">```</span><span class="n">python</span>
<span class="kn">import</span> <span class="nn">pytorch_snippets</span>
<span class="nb">dir</span><span class="p">(</span><span class="n">pytorch_snippets</span><span class="p">)</span>
<span class="err">```</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

